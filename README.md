
# BBC-News-Classifier
KNN &amp; SVM classifiers on BBC News Categories

This work aims to build a News classifier, to identify News from 5 categories: business, entertainment, politics, sport and tech. Two classifying techniques, KNN and SVM, are applied for comparisons. The classifier is built upon 2225 [BBC News Datasets](http://mlg.ucd.ie/datasets/bbc.html) from 2005-2006. Datasets can be found under the folder __bbc-fulltext__.

**R Packages used:**
* tm: Text-Mining Package
* plyr: Tools for Splitting, Applying and Combining Data
* class: Functions for Classification __(used: knn)__
* e1071: Functions for latent class analysis, fuzzy clustering, svm, bagged clustering, naive Bayes classifier... __(used: svm)__

Source:
[How to Build a Text Mining, Machine Learning Document Classification System in R!](https://www.youtube.com/watch?v=j1V2McKbkLo)

News Classifier
================
Miriam Chou
12 April 2018

Set-ups
=======

``` r
# Load libraries

libs <- c("tm", "plyr", "class", "e1071")
lapply(libs, require, character.only = T)
```

    ## Loading required package: tm

    ## Warning: package 'tm' was built under R version 3.4.4

    ## Loading required package: NLP

    ## Loading required package: plyr

    ## Warning: package 'plyr' was built under R version 3.4.4

    ## Loading required package: class

    ## Warning: package 'class' was built under R version 3.4.4

    ## Loading required package: e1071

    ## Warning: package 'e1071' was built under R version 3.4.4

    ## [[1]]
    ## [1] TRUE
    ## 
    ## [[2]]
    ## [1] TRUE
    ## 
    ## [[3]]
    ## [1] TRUE
    ## 
    ## [[4]]
    ## [1] TRUE

``` r
# Set options
options(stringAsFactors = F)

# Set parameters
categories <- c("business", "entertainment",
                "politics", "sport", "tech")
pathname <- "../bbc-fulltext"
```

clean text
==========

``` r
cleanCorpus <- function(corpus) {
  corpus.tmp <- tm_map(corpus, removePunctuation)
  corpus.tmp <- tm_map(corpus.tmp, stripWhitespace)
  corpus.tmp <- tm_map(corpus.tmp, tolower)
  corpus.tmp <- tm_map(corpus.tmp, removeWords, stopwords("english"))
  return(corpus.tmp)
}
```

build TDM
=========

``` r
generateTDM <- function(cate, path) {
  s.dir <- sprintf("%s/%s", path, cate)
  s.cor <- Corpus(DirSource(directory = s.dir))
  s.cor.cl <- cleanCorpus(s.cor)
  s.tdm <- TermDocumentMatrix(s.cor.cl)
  
  s.tdm <- removeSparseTerms(s.tdm, 0.7)
  result <- list(name = cate, tdm = s.tdm)
}

tdm <- lapply(categories, generateTDM, path = pathname)
```

``` r
str(tdm)
```

    ## List of 5
    ##  $ :List of 2
    ##   ..$ name: chr "business"
    ##   ..$ tdm :List of 6
    ##   .. ..$ i       : int [1:3987] 1 2 3 4 5 6 7 8 9 10 ...
    ##   .. ..$ j       : int [1:3987] 1 1 1 1 1 1 1 1 1 1 ...
    ##   .. ..$ v       : num [1:3987] 2 1 2 1 1 1 1 3 1 5 ...
    ##   .. ..$ nrow    : int 18
    ##   .. ..$ ncol    : int 510
    ##   .. ..$ dimnames:List of 2
    ##   .. .. ..$ Terms: chr [1:18] "also" "chief" "company" "firm" ...
    ##   .. .. ..$ Docs : chr [1:510] "1" "2" "3" "4" ...
    ##   .. ..- attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
    ##   .. ..- attr(*, "weighting")= chr [1:2] "term frequency" "tf"
    ##  $ :List of 2
    ##   ..$ name: chr "entertainment"
    ##   ..$ tdm :List of 6
    ##   .. ..$ i       : int [1:2802] 1 2 3 4 5 6 7 1 8 9 ...
    ##   .. ..$ j       : int [1:2802] 1 1 1 1 1 1 1 2 2 2 ...
    ##   .. ..$ v       : num [1:2802] 1 1 1 1 2 1 1 1 2 2 ...
    ##   .. ..$ nrow    : int 17
    ##   .. ..$ ncol    : int 386
    ##   .. ..$ dimnames:List of 2
    ##   .. .. ..$ Terms: chr [1:17] "also" "last" "one" "two" ...
    ##   .. .. ..$ Docs : chr [1:386] "1" "2" "3" "4" ...
    ##   .. ..- attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
    ##   .. ..- attr(*, "weighting")= chr [1:2] "term frequency" "tf"
    ##  $ :List of 2
    ##   ..$ name: chr "politics"
    ##   ..$ tdm :List of 6
    ##   .. ..$ i       : int [1:6408] 1 2 3 4 5 6 7 8 9 10 ...
    ##   .. ..$ j       : int [1:6408] 1 1 1 1 1 1 1 1 1 1 ...
    ##   .. ..$ v       : num [1:6408] 1 1 1 2 1 1 4 1 2 1 ...
    ##   .. ..$ nrow    : int 37
    ##   .. ..$ ncol    : int 417
    ##   .. ..$ dimnames:List of 2
    ##   .. .. ..$ Terms: chr [1:37] "also" "blair" "election" "general" ...
    ##   .. .. ..$ Docs : chr [1:417] "1" "2" "3" "4" ...
    ##   .. ..- attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
    ##   .. ..- attr(*, "weighting")= chr [1:2] "term frequency" "tf"
    ##  $ :List of 2
    ##   ..$ name: chr "sport"
    ##   ..$ tdm :List of 6
    ##   .. ..$ i       : int [1:5139] 1 2 3 4 5 6 7 8 9 10 ...
    ##   .. ..$ j       : int [1:5139] 1 1 1 1 1 1 1 1 1 1 ...
    ##   .. ..$ v       : num [1:5139] 1 1 3 1 1 1 1 2 1 2 ...
    ##   .. ..$ nrow    : int 25
    ##   .. ..$ ncol    : int 511
    ##   .. ..$ dimnames:List of 2
    ##   .. .. ..$ Terms: chr [1:25] "also" "can" "first" "last" ...
    ##   .. .. ..$ Docs : chr [1:511] "1" "2" "3" "4" ...
    ##   .. ..- attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
    ##   .. ..- attr(*, "weighting")= chr [1:2] "term frequency" "tf"
    ##  $ :List of 2
    ##   ..$ name: chr "tech"
    ##   ..$ tdm :List of 6
    ##   .. ..$ i       : int [1:7221] 1 2 3 4 5 6 7 8 9 10 ...
    ##   .. ..$ j       : int [1:7221] 1 1 1 1 1 1 1 1 1 1 ...
    ##   .. ..$ v       : num [1:7221] 1 2 1 4 2 1 9 2 1 1 ...
    ##   .. ..$ nrow    : int 43
    ##   .. ..$ ncol    : int 401
    ##   .. ..$ dimnames:List of 2
    ##   .. .. ..$ Terms: chr [1:43] "can" "many" "new" "one" ...
    ##   .. .. ..$ Docs : chr [1:401] "1" "2" "3" "4" ...
    ##   .. ..- attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
    ##   .. ..- attr(*, "weighting")= chr [1:2] "term frequency" "tf"

attach name
===========

``` r
bindCategoryToTDM <- function(tdm) {
  s.mat <- t(data.matrix(tdm[["tdm"]]))
  s.df <- as.data.frame(s.mat, stringsAsFactors = F)
  s.df <- cbind(s.df, rep(tdm[["name"]], nrow(s.df)))
  colnames(s.df)[ncol(s.df)] <- "targetcategory"
  return(s.df)
}

cateTDM <- lapply(tdm, bindCategoryToTDM)
```

``` r
str(cateTDM)
```

    ## List of 5
    ##  $ :'data.frame':    510 obs. of  19 variables:
    ##   ..$ also          : num [1:510] 2 0 0 1 0 0 1 1 0 1 ...
    ##   ..$ chief         : num [1:510] 1 0 0 1 0 0 1 0 1 0 ...
    ##   ..$ company       : num [1:510] 2 0 2 0 0 0 0 0 0 0 ...
    ##   ..$ firm          : num [1:510] 1 0 0 0 3 0 0 0 0 0 ...
    ##   ..$ growth        : num [1:510] 1 0 0 0 0 3 4 1 0 0 ...
    ##   ..$ however       : num [1:510] 1 1 0 2 0 0 1 0 0 0 ...
    ##   ..$ market        : num [1:510] 1 1 0 1 2 1 1 0 0 0 ...
    ##   ..$ now           : num [1:510] 3 0 0 0 0 0 0 0 0 0 ...
    ##   ..$ one           : num [1:510] 1 0 0 0 1 0 0 1 0 0 ...
    ##   ..$ said          : num [1:510] 5 2 3 5 2 2 4 3 2 0 ...
    ##   ..$ will          : num [1:510] 2 2 3 2 0 1 0 0 2 0 ...
    ##   ..$ may           : num [1:510] 0 1 0 0 0 0 0 0 0 0 ...
    ##   ..$ new           : num [1:510] 0 2 0 0 0 0 3 0 0 0 ...
    ##   ..$ year          : num [1:510] 0 1 0 4 1 0 0 2 1 0 ...
    ##   ..$ 2004          : num [1:510] 0 0 0 1 0 0 1 1 1 0 ...
    ##   ..$ last          : num [1:510] 0 0 0 1 2 0 2 0 1 0 ...
    ##   ..$ two           : num [1:510] 0 0 0 0 1 1 0 1 0 0 ...
    ##   ..$ years         : num [1:510] 0 0 0 0 0 0 2 0 1 1 ...
    ##   ..$ targetcategory: Factor w/ 1 level "business": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ :'data.frame':    386 obs. of  18 variables:
    ##   ..$ also          : num [1:386] 1 1 0 0 0 2 1 2 0 1 ...
    ##   ..$ last          : num [1:386] 1 0 0 2 0 4 0 0 0 0 ...
    ##   ..$ one           : num [1:386] 1 0 0 1 0 1 2 0 0 0 ...
    ##   ..$ two           : num [1:386] 1 0 0 1 0 0 0 0 1 0 ...
    ##   ..$ will          : num [1:386] 2 1 0 1 0 0 1 5 1 0 ...
    ##   ..$ year          : num [1:386] 1 0 0 0 0 0 2 0 0 0 ...
    ##   ..$ years         : num [1:386] 1 0 1 6 0 0 0 0 1 0 ...
    ##   ..$ new           : num [1:386] 0 2 0 0 0 2 0 0 1 1 ...
    ##   ..$ said          : num [1:386] 0 2 2 2 2 0 0 0 4 4 ...
    ##   ..$ film          : num [1:386] 0 0 4 0 3 0 0 0 1 0 ...
    ##   ..$ show          : num [1:386] 0 0 1 1 1 0 0 1 0 1 ...
    ##   ..$ best          : num [1:386] 0 0 0 2 0 11 0 7 1 0 ...
    ##   ..$ star          : num [1:386] 0 0 0 1 0 1 0 0 0 0 ...
    ##   ..$ time          : num [1:386] 0 0 0 1 0 0 1 0 1 0 ...
    ##   ..$ including     : num [1:386] 0 0 0 0 1 0 2 0 1 0 ...
    ##   ..$ first         : num [1:386] 0 0 0 0 0 0 2 0 0 0 ...
    ##   ..$ music         : num [1:386] 0 0 0 0 0 0 0 0 0 0 ...
    ##   ..$ targetcategory: Factor w/ 1 level "entertainment": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ :'data.frame':    417 obs. of  38 variables:
    ##   ..$ also          : num [1:417] 1 0 3 0 1 1 0 0 0 0 ...
    ##   ..$ blair         : num [1:417] 1 1 0 0 1 0 7 1 0 0 ...
    ##   ..$ election      : num [1:417] 1 0 1 0 6 0 4 1 1 0 ...
    ##   ..$ general       : num [1:417] 2 0 0 0 1 0 0 2 0 0 ...
    ##   ..$ labour        : num [1:417] 1 0 0 3 5 0 5 1 3 0 ...
    ##   ..$ made          : num [1:417] 1 0 1 0 0 1 0 1 1 1 ...
    ##   ..$ new           : num [1:417] 4 5 2 0 0 0 1 1 2 2 ...
    ##   ..$ next          : num [1:417] 1 1 0 0 0 0 0 0 0 0 ...
    ##   ..$ now           : num [1:417] 2 0 0 0 0 1 0 0 2 0 ...
    ##   ..$ party         : num [1:417] 1 0 0 6 1 0 3 0 2 1 ...
    ##   ..$ plans         : num [1:417] 5 0 2 0 0 0 0 0 0 1 ...
    ##   ..$ said          : num [1:417] 9 7 3 2 6 7 6 7 6 0 ...
    ##   ..$ secretary     : num [1:417] 2 0 1 0 1 0 0 3 1 0 ...
    ##   ..$ time          : num [1:417] 1 1 0 1 0 0 0 0 0 1 ...
    ##   ..$ told          : num [1:417] 1 0 3 0 2 0 3 5 0 0 ...
    ##   ..$ tony          : num [1:417] 1 1 0 0 1 0 1 0 0 0 ...
    ##   ..$ will          : num [1:417] 3 2 1 6 6 1 1 0 0 5 ...
    ##   ..$ government    : num [1:417] 0 2 1 0 1 3 2 0 1 1 ...
    ##   ..$ leader        : num [1:417] 0 1 0 0 0 0 1 0 1 0 ...
    ##   ..$ michael       : num [1:417] 0 1 0 0 0 0 1 0 1 0 ...
    ##   ..$ public        : num [1:417] 0 3 0 0 1 2 3 3 0 1 ...
    ##   ..$ says          : num [1:417] 0 1 0 0 0 1 0 1 0 0 ...
    ##   ..$ tory          : num [1:417] 0 1 0 0 0 0 5 0 2 0 ...
    ##   ..$ year          : num [1:417] 0 1 1 2 0 0 0 0 0 0 ...
    ##   ..$ added         : num [1:417] 0 0 1 0 1 1 0 1 0 0 ...
    ##   ..$ bbc           : num [1:417] 0 0 1 0 1 0 2 0 2 0 ...
    ##   ..$ can           : num [1:417] 0 0 2 1 0 0 0 0 0 0 ...
    ##   ..$ last          : num [1:417] 0 0 1 0 0 0 0 0 1 0 ...
    ##   ..$ minister      : num [1:417] 0 0 1 0 1 2 1 2 1 0 ...
    ##   ..$ one           : num [1:417] 0 0 1 0 0 0 0 2 1 1 ...
    ##   ..$ make          : num [1:417] 0 0 0 1 0 0 0 0 0 0 ...
    ##   ..$ two           : num [1:417] 0 0 0 1 0 0 0 0 0 0 ...
    ##   ..$ years         : num [1:417] 0 0 0 1 0 2 0 0 0 0 ...
    ##   ..$ people        : num [1:417] 0 0 0 0 2 0 1 1 0 0 ...
    ##   ..$ prime         : num [1:417] 0 0 0 0 1 2 1 0 1 0 ...
    ##   ..$ say           : num [1:417] 0 0 0 0 3 0 1 3 0 3 ...
    ##   ..$ spokesman     : num [1:417] 0 0 0 0 0 0 0 0 2 0 ...
    ##   ..$ targetcategory: Factor w/ 1 level "politics": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ :'data.frame':    511 obs. of  26 variables:
    ##   ..$ also          : num [1:511] 1 1 2 1 0 1 0 0 1 1 ...
    ##   ..$ can           : num [1:511] 1 0 0 1 0 0 0 2 0 0 ...
    ##   ..$ first         : num [1:511] 3 1 0 0 0 0 0 0 1 0 ...
    ##   ..$ last          : num [1:511] 1 2 0 0 1 1 2 0 1 0 ...
    ##   ..$ now           : num [1:511] 1 0 1 1 0 0 0 1 1 1 ...
    ##   ..$ said          : num [1:511] 1 0 2 2 1 1 1 3 2 1 ...
    ##   ..$ three         : num [1:511] 1 2 0 0 0 0 0 0 0 0 ...
    ##   ..$ time          : num [1:511] 2 0 2 0 0 1 0 2 0 0 ...
    ##   ..$ will          : num [1:511] 1 3 1 1 0 0 3 3 2 5 ...
    ##   ..$ win           : num [1:511] 2 0 1 0 0 0 0 0 3 1 ...
    ##   ..$ world         : num [1:511] 1 1 5 1 3 3 0 0 1 7 ...
    ##   ..$ years         : num [1:511] 1 1 0 0 0 0 2 0 1 0 ...
    ##   ..$ team          : num [1:511] 0 2 0 0 0 0 0 0 0 0 ...
    ##   ..$ just          : num [1:511] 0 0 2 0 0 1 0 0 1 0 ...
    ##   ..$ one           : num [1:511] 0 0 2 0 0 0 0 0 0 1 ...
    ##   ..$ back          : num [1:511] 0 0 0 1 1 0 0 3 0 0 ...
    ##   ..$ two           : num [1:511] 0 0 0 2 0 0 1 1 0 0 ...
    ##   ..$ made          : num [1:511] 0 0 0 0 1 0 0 0 1 0 ...
    ##   ..$ second        : num [1:511] 0 0 0 0 1 2 0 0 2 0 ...
    ##   ..$ added         : num [1:511] 0 0 0 0 0 0 0 1 0 0 ...
    ##   ..$ good          : num [1:511] 0 0 0 0 0 0 0 0 1 1 ...
    ##   ..$ well          : num [1:511] 0 0 0 0 0 0 0 0 1 1 ...
    ##   ..$ game          : num [1:511] 0 0 0 0 0 0 0 0 0 0 ...
    ##   ..$ play          : num [1:511] 0 0 0 0 0 0 0 0 0 0 ...
    ##   ..$ players       : num [1:511] 0 0 0 0 0 0 0 0 0 0 ...
    ##   ..$ targetcategory: Factor w/ 1 level "sport": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ :'data.frame':    401 obs. of  44 variables:
    ##   ..$ can           : num [1:401] 1 5 0 3 5 1 0 0 3 4 ...
    ##   ..$ many          : num [1:401] 2 1 0 0 1 0 1 1 1 0 ...
    ##   ..$ new           : num [1:401] 1 1 0 0 2 1 0 1 0 1 ...
    ##   ..$ one           : num [1:401] 4 1 0 3 1 1 2 1 3 0 ...
    ##   ..$ technology    : num [1:401] 2 0 0 0 10 1 0 0 0 0 ...
    ##   ..$ two           : num [1:401] 1 0 0 1 0 0 0 1 1 0 ...
    ##   ..$ use           : num [1:401] 9 4 2 2 1 0 1 0 2 2 ...
    ##   ..$ used          : num [1:401] 2 0 0 0 4 0 1 0 3 0 ...
    ##   ..$ using         : num [1:401] 1 0 0 1 3 1 0 0 1 2 ...
    ##   ..$ well          : num [1:401] 1 0 0 0 0 3 0 0 3 0 ...
    ##   ..$ will          : num [1:401] 4 0 0 2 2 1 0 1 2 1 ...
    ##   ..$ world         : num [1:401] 1 1 0 1 3 1 0 0 2 0 ...
    ##   ..$ according     : num [1:401] 0 1 0 0 1 0 0 0 0 0 ...
    ##   ..$ also          : num [1:401] 0 3 1 1 1 7 1 0 6 2 ...
    ##   ..$ computer      : num [1:401] 0 2 0 0 0 4 0 0 1 0 ...
    ##   ..$ first         : num [1:401] 0 1 0 0 0 1 0 0 11 0 ...
    ##   ..$ get           : num [1:401] 0 1 0 2 2 0 0 1 1 0 ...
    ##   ..$ net           : num [1:401] 0 15 0 0 1 0 0 1 1 2 ...
    ##   ..$ news          : num [1:401] 0 2 0 0 0 1 0 0 0 0 ...
    ##   ..$ people        : num [1:401] 0 8 1 0 5 2 0 0 2 3 ...
    ##   ..$ said          : num [1:401] 0 3 5 3 5 2 1 2 3 8 ...
    ##   ..$ software      : num [1:401] 0 1 6 0 0 1 3 2 0 0 ...
    ##   ..$ time          : num [1:401] 0 2 0 0 1 1 0 0 5 1 ...
    ##   ..$ users         : num [1:401] 0 1 4 0 0 2 3 1 0 8 ...
    ##   ..$ last          : num [1:401] 0 0 1 0 1 1 0 0 0 0 ...
    ##   ..$ million       : num [1:401] 0 0 1 3 0 0 0 0 0 0 ...
    ##   ..$ online        : num [1:401] 0 0 1 0 1 0 0 1 0 1 ...
    ##   ..$ digital       : num [1:401] 0 0 0 4 1 0 0 0 2 1 ...
    ##   ..$ just          : num [1:401] 0 0 0 2 1 0 0 0 2 0 ...
    ##   ..$ like          : num [1:401] 0 0 0 1 2 0 0 1 2 2 ...
    ##   ..$ make          : num [1:401] 0 0 0 3 0 3 1 0 2 0 ...
    ##   ..$ now           : num [1:401] 0 0 0 2 1 1 0 0 2 0 ...
    ##   ..$ number        : num [1:401] 0 0 0 1 0 1 1 0 5 2 ...
    ##   ..$ service       : num [1:401] 0 0 0 1 0 0 0 0 0 4 ...
    ##   ..$ take          : num [1:401] 0 0 0 1 1 0 2 0 0 0 ...
    ##   ..$ work          : num [1:401] 0 0 0 2 0 0 0 0 0 1 ...
    ##   ..$ year          : num [1:401] 0 0 0 2 2 0 0 1 0 0 ...
    ##   ..$ years         : num [1:401] 0 0 0 3 1 3 0 0 1 0 ...
    ##   ..$ around        : num [1:401] 0 0 0 0 1 1 0 0 3 0 ...
    ##   ..$ way           : num [1:401] 0 0 0 0 1 0 0 0 4 0 ...
    ##   ..$ firm          : num [1:401] 0 0 0 0 0 0 1 1 0 2 ...
    ##   ..$ made          : num [1:401] 0 0 0 0 0 0 1 0 2 0 ...
    ##   ..$ much          : num [1:401] 0 0 0 0 0 0 0 0 1 1 ...
    ##   ..$ targetcategory: Factor w/ 1 level "tech": 1 1 1 1 1 1 1 1 1 1 ...

stack
=====

``` r
tdm.stack <- do.call(rbind.fill, cateTDM)
tdm.stack[is.na(tdm.stack)] <- 0
```

hold-out
========

``` r
train.idx <- sample(nrow(tdm.stack), ceiling(nrow(tdm.stack) * 0.7))
test.idx <- (1:nrow(tdm.stack)) [- train.idx]
```

``` r
head(test.idx)
```

    ## [1]  5  6 16 18 22 24

``` r
head(train.idx)
```

    ## [1] 1598 1510  998  213 1408 1809

modelling
=========

``` r
tdm.cate <- tdm.stack[, "targetcategory"]
tdm.stack.nl <- tdm.stack[, !colnames(tdm.stack) %in% "targetcategory"]

# KNN
knn.pred <- knn(tdm.stack.nl[train.idx, ], tdm.stack.nl[test.idx, ], tdm.cate[train.idx])
knn.mat <- table("Predictions" = knn.pred, "Actual" = tdm.cate[test.idx])
knn.acc <- sum(diag(knn.mat))/sum(knn.mat)

knn.mat
```

    ##                Actual
    ## Predictions     business entertainment politics sport tech
    ##   business           153            12       12    10    6
    ##   entertainment        7           102        3     7    5
    ##   politics             2             0      101     0    9
    ##   sport                2             5        6   131    3
    ##   tech                 0             0        0     0   91

``` r
knn.acc
```

    ## [1] 0.8665667

``` r
# SVM
svm.fit <- svm(targetcategory~., data = tdm.stack[train.idx, ])
svm.pred <- predict(svm.fit, newdata = tdm.stack.nl[test.idx, ])
svm.mat <- table("Predictions" = svm.pred, "Actual" = tdm.cate[test.idx])
svm.acc <- sum(diag(svm.mat))/sum(svm.mat)

svm.mat
```

    ##                Actual
    ## Predictions     business entertainment politics sport tech
    ##   business           159             3        2     0    0
    ##   entertainment        1           116        0     2    1
    ##   politics             0             0      116     0    0
    ##   sport                2             0        2   141    1
    ##   tech                 2             0        2     5  112

``` r
svm.acc
```

    ## [1] 0.9655172
